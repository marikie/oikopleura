# 16 March, 2022 maturedAdults
lastdb OKI2018_I69_1.0db ~/data/oikopleura/OKI2018_I69_1.0_alignments_with_different_parameters/copy_of_the_genomes/OKI2018_I69_1.0.removed_chrUn.fa

last-train -Q0 OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/maturedOikopleuraAdults/ERR4570987.fastq > trainOKI2018_I69_1.0_ERR4570987.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570987.out OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/maturedOikopleuraAdults/ERR4570987.fastq | last-split -d2 -g OKI2018_I69_1.0db > lastsplitOKI2018_I69_1.0_ERR4570987.out

# 11 April, 2022 immatureAdults
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/immatureAdults/ERR4570986.fastq > trainOKI2018_I69_1.0_ERR4570986.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570986.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/immatureAdults/ERR4570986.fastq | last-split -d2 -g ../OKI2018_I69_1.0db/OKI2018_I69_1.0db > 
lastsplitOKI2018_I69_1.0_ERR4570986.out

# embryos
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/embryos/ERR4570985.fastq > trainOKI2018_I69_1.0_ERR4570985.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570985.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/embryos/ERR4570985.fastq | last-split -d2 -g ../OKI2018_I69_1.0db/OKI2018_I69_1.0db > 
lastsplitOKI2018_I69_1.0_ERR4570985.out

# 3 May, 2022 maturedAdults
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/maturedAdults/ERR4570987_1_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_ERR4570987_sorted.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570987_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted.fastq | last-split -d2 -M3.78 -S0.065 -g 
../OKI2018_I69_1.0db/OKI2018_I69_1.0db > lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.maf

# immatureAdults
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/immatureAdults/ERR4570986_1_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_ERR4570986_sorted.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570986_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted.fastq | last-split -d2 -M3.78 -S0.065 -g 
../OKI2018_I69_1.0db/OKI2018_I69_1.0db > lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.maf

# embryos
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_ERR4570985_sorted.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570985_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ~/data/oikopleura/rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted.fastq | last-split -d2 -M3.78 -S0.065 -g 
../OKI2018_I69_1.0db/OKI2018_I69_1.0db > lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.maf

# May 11, 2022 embryos
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_ERR4570985_sorted.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570985_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted.fastq | last-split -d2 -M3.78 -S0.065 -g 
../OKI2018_I69_1.0db/OKI2018_I69_1.0db > lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.maf

# immature adults
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_ERR4570986_sorted.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570986_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted.fastq | last-split -d2 -M3.78 -S0.065 -g 
../OKI2018_I69_1.0db/OKI2018_I69_1.0db > lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.maf

# matured adults
last-train -Q0 ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_ERR4570987_sorted.out

lastal -D10 -p trainOKI2018_I69_1.0_ERR4570987_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted.fastq | last-split -d2 -M3.78 -S0.065 -g 
../OKI2018_I69_1.0db/OKI2018_I69_1.0db > lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.maf

# May 30, 2022 To know strandedness of the RNA-seq data embryos
lastal -p trainOKI2018_I69_1.0_ERR4570985_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted.fastq > lastal_ERR4570985_1_filtered_trimmed_sorted.maf

lastal -p trainOKI2018_I69_1.0_ERR4570985_sorted.out ../OKI2018_I69_1.0db/OKI2018_I69_1.0db ../../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted.fastq > lastal_ERR4570985_filtered_trimmed_sorted.maf

# July 15, 2022 lastdb
lastdb OKI2018_I69_1.0_whole.DB OKI2018_I69_1.0.fa
# last-train - embryos
last-train -Q0 ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB ../../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_whole_ERR4570985.out
#  - immatureAdults
last-train -Q0 ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB ../../rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_whole_ERR4570986.out
#  - maturedAdults
last-train -Q0 ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB ../../rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted.fastq > trainOKI2018_I69_1.0_whole_ERR4570987.out
# lastal - embryos
lastal -D10 --split-d 2 --split-M 3.78 --split-S 0.065 -p trainOKI2018_I69_1.0_whole_ERR4570985.out ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB ../../rna-seq-data/embryos/ERR4570985_*_filtered_trimmed_sorted.fastq > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted.maf

# July 19, 2022 fastq-interleave -> lastal -> last-postmask
#  - embryos
fastq-interleave ../../rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted.fastq ../../rna-seq-data/immatureAdults/ERR4570986_2_filtered_trimmed_sorted.fastq | lastal -D10 --split-d 2 --split-M 3.78 --split-S 0.065 -p 
trainOKI2018_I69_1.0_whole_ERR4570985.out ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB | last-postmask > ~/.data/lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask.maf fastq-interleave 
ERR4570985_1_filtered_trimmed_sorted.fastq ERR4570985_2_filtered_trimmed_sorted.fastq > ERR4570985_filtered_trimmed_sorted_interleaved.fastq
#  - immatureAdults
fastq-interleave ERR4570986_1_filtered_trimmed_sorted.fastq ERR4570986_2_filtered_trimmed_sorted.fastq > ERR4570986_filtered_trimmed_sorted_interleaved.fastq lastal -D10 --split-d 2 --split-M 3.78 --split-S 0.065 -p 
trainOKI2018_I69_1.0_whole_ERR4570986.out ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB ../../rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted_interleaved.fastq | last-postmask > 
lastsplitOKI2018_I69_1.0_whole_ERR4570986_filtered_trimmed_sorted_interleaved_postmask.maf
#  - maturedAdults
fastq-interleave ERR4570987_1_filtered_trimmed_sorted.fastq ERR4570987_2_filtered_trimmed_sorted.fastq > ERR4570987_filtered_trimmed_sorted_interleaved.fastq lastal -D10 --split-d 2 --split-M 3.78 --split-S 0.065 -p 
trainOKI2018_I69_1.0_whole_ERR4570987.out ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB ../../rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted_interleaved.fastq | last-postmask > 
lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask.maf

# July 22, 2022 re-make lastsplit alignment file of embryos because the previous command was wrong (reads of embryos and immatureAdults are mistakenly merged)
lastal -D10 --split-d 2 --split-M 3.78 --split-S 0.065 -p trainOKI2018_I69_1.0_whole_ERR4570985.out ../OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB 
../../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted_interleaved.fastq |last-postmask > lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask.maf

# August 17, 2022 make Transposable Element database

# lastdb -R: specify lowercase usage with two digits
#     first digit: 0: Convert the input sequences to uppercase while reading them. second digit: 1: Convert simple repeats (e.g. cacacacacacacacac) to
#                      lowercase.  This uses tantan, which reliably prevents non-homologous alignments, unlike other repeat finders.
lastdb -R01 Oikopleura.dioica_TEdb ../Data_S1_bank_dioica_tot.fa

# last-train --revsym: Force the substitution scores to have reverse-complement
#           symmetry, e.g. score(A→G) = score(T→C).  This is often appropriate, if neither strand is "special".
# -X1: How to score a match/mismatch involving N (for DNA) or X (otherwise). 1 means treat reference Ns/Xs as fully-ambiguous letters.
# -m100: Maximum number of initial matches per query position. -P: Number of parallel threads.
last-train -P8 --revsym -X1 -m100 Oikopleura.dioica_TEdb ../OKI2018_I69_1.0.fa > last-train_Okipleura.dioica_TE.mat

# lastal -i3G: Process the query sequences in batches, of at most this many
#       bytes.  If a single sequence exceeds this amount, however, it is not split.  You can use suffixes K, M, and G to specify KibiBytes, MebiBytes, and GibiBytes.  This option makes -P less efficient, because each batch is 
#       separately multi-threaded, but it fixes the output order to be the same as the input.
# -m100: Maximum multiplicity for initial matches.  Each initial match is lengthened until it occurs at most this many times in the reference.
# -D1e7: Report alignments that are expected by chance at most once per LENGTH query letters.
#        "M. Frith sensei felt that the default produces too many false hits"

# Sep 22, 2022 To use IGV embryos MAF -> BAM
convert2BAM.sh ~/data/last/embryos/lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.maf 20220922

# Oct 17, 2022 BAM -> BED
bedtools bamtobed -i lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_20220922.sort.bam > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_20220922.sort.bam.bed

# Oct 27, 2022 MAF -> SAM
maf-convert -d sam lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.maf > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_20221027.sam

# Nov 1, 2022 sort sam
samtools sort -O sam lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_20221027.sam > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_20221101.sort.sam

# Nov 11, 2022 last-train OKI2018_I69.transcriptonme.fa 
# -P8: "makes it faster by using 8 parallel threads: adjust as suitable for your computer.
#         this has no effect on the result"
# -X1: "tells it to treat Ns in the reference sequences as unknown bases" -m100: Maximum multiplicity for initial matches.  Each initial match is
#        lengthened until it occurs at most this many times in the reference. "makes it more slow-and-sensitive than the default"
last-train -P8 --revsym -X1 -m100 OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB OKI2018_I69.transcriptome.fa > last_transcript.mat

# lastal --split OKI2018_I69.transcriptonme.fa 
# -D10: Report alignments that are expected by chance at most once per LENGTH query letters.
lastal -P8 -D10 --split-d 2 --split-M 3.78 --split-S 0.065 -p last_transcript.mat OKI2018_I69_1.0_whole.DB/OKI2018_I69_1.0_whole.DB OKI2018_I69.transcriptome.fa | last-postmask > transcript-to-genome.maf

# Nov 16, 2022 MAF -> SAM
maf-convert -d sam transcript-to-genome.maf > transcript-to-genome.sam

# sort sam
samtools sort -O sam transcript-to-genome.sam > transcript-to-genome.sorted.sam

# SAM -> BAM
samtools view -b transcript-to-genome.sam > transcript-to-genome.bam

# BAM -> BED
bedtools bamtobed -i transcript-to-genome.bam > transcript-to-genome.bed

# Nov 17, 2022 MAF -> SAM
maf-convert -d sam lastsplitOKI2018_I69_1.0_whole_ERR4570986_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.maf > lastsplitOKI2018_I69_1.0_whole_ERR4570986_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam
# sort sam
samtools sort -O sam lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sorted.sam

# Nov 21, 2022 MAF -> SAM
maf-convert -d sam lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.maf > lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam
# sort sam
samtools sort -O sam lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam > 
lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sorted.sam

# Feb 1, 2023
maf-convert -j1e6 -d sam lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_inexactSplitsRemoved.maf > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_inexactSplitsRemoved_maf-convert.sam

# Feb 3, 2023
maf-convert -j1e6 -d sam transcript-to-genome.maf > transcript-to-genome.sam

# Feb 13, 2023
lastdb -P8 -uNEAR $dbNAME ../OKI2018_I69_1.0.fa

last-train -P8 -Q0 $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted_interleaved.fastq > embryos/$train_emb

last-train -P8 -Q0 $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted_interleaved.fastq > immatureAdults/$train_imm

last-train -P8 -Q0 $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted_interleaved.fastq > maturedAdults/$train_mat

lastal -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p embryos/$train_emb $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted.fastq | last-postmask > embryos/$al_emb1

lastal -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p embryos/$train_emb $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_2_filtered_trimmed_sorted.fastq | last-postmask > embryos/$al_emb2

lastal -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p immatureAdults/$train_imm $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_1_filtered_trimmed_sorted.fastq | last-postmask > immatureAdults/$al_imm1

lastal -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p immatureAdults/$train_imm $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_2_filtered_trimmed_sorted.fastq | last-postmask > immatureAdults/$al_imm2

lastal -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p maturedAdults/$train_mat $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_1_filtered_trimmed_sorted.fastq | last-postmask > maturedAdults/$al_mat1

lastal -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p maturedAdults/$train_mat $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_2_filtered_trimmed_sorted.fastq | last-postmask > maturedAdults/$al_mat2

# May 30
# lastdb
lastdb -P8 -uNEAR $dbNAME ../OKI2018_I69_1.0.fa

# last-train
last-train -P8 -Q0 $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted_interleaved.fastq > embryos/$train_emb
last-train -P8 -Q0 $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted_interleaved.fastq > immatureAdults/$train_imm
last-train -P8 -Q0 $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted_interleaved.fastq > maturedAdults/$train_mat

# lastal embryos
lastal -i1 -P8 -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p embryos/$train_emb $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted.fastq | last-postmask > embryos/$al_emb1
lastal -i1 -P8 -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p embryos/$train_emb $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_2_filtered_trimmed_sorted.fastq | last-postmask > embryos/$al_emb2
last-pair-probs -r embryos/$al_emb1 embryos/$al_emb2 > embryos/$al_emb_pairprob 
maf-convert -j1e5 -d sam embryos/$al_emb_pairprob > embryos/$sam_emb 

# lastal immature adults
lastal -i1 -P8 -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p immatureAdults/$train_imm $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_1_filtered_trimmed_sorted.fastq | last-postmask > immatureAdults/$al_imm1
lastal -i1 -P8 -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p immatureAdults/$train_imm $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_2_filtered_trimmed_sorted.fastq | last-postmask > immatureAdults/$al_imm2
last-pair-probs -r immatureAdults/$al_imm1 immatureAdults/$al_imm2 > immatureAdults/$al_imm_pairprob 
maf-convert -j1e5 -d sam immatureAdults/$al_imm_pairprob > immatureAdults/$sam_imm 

# lastal matured adults
lastal -i1 -P8 -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p maturedAdults/$train_mat $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_1_filtered_trimmed_sorted.fastq | last-postmask > maturedAdults/$al_mat1
lastal -i1 -P8 -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p maturedAdults/$train_mat $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_2_filtered_trimmed_sorted.fastq | last-postmask > maturedAdults/$al_mat2
last-pair-probs -r maturedAdults/$al_mat1 maturedAdults/$al_mat2 > maturedAdults/$al_mat_pairprob 
maf-convert -j1e5 -d sam maturedAdults/$al_mat_pairprob > maturedAdults/$sam_mat 


# convert SAM -> BAM embryos
samtools view -bt ../OKI2018_I69_1.0.removed_chrUn.fa.fai lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted_postmask_pairprob_20230525.sam | samtools sort -o lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted_postmask_pairprob_20230525.sort.bam


# Nov 16, 2022 MAF -> SAM
maf-convert -d sam transcript-to-genome.maf > transcript-to-genome.sam

# sort sam
samtools sort -O sam transcript-to-genome.sam > transcript-to-genome.sorted.sam

# SAM -> BAM
samtools view -b transcript-to-genome.sam > transcript-to-genome.bam

# BAM -> BED
bedtools bamtobed -i transcript-to-genome.bam > transcript-to-genome.bed

# Nov 17, 2022 MAF -> SAM
maf-convert -d sam lastsplitOKI2018_I69_1.0_whole_ERR4570986_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.maf > lastsplitOKI2018_I69_1.0_whole_ERR4570986_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam
# sort sam
samtools sort -O sam lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sorted.sam

# Nov 21, 2022 MAF -> SAM
maf-convert -d sam lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.maf > lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam
# sort sam
samtools sort -O sam lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sam > 
lastsplitOKI2018_I69_1.0_whole_ERR4570987_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed.sorted.sam

# Feb 1, 2023
maf-convert -j1e6 -d sam lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_inexactSplitsRemoved.maf > 
lastsplitOKI2018_I69_1.0_whole_ERR4570985_filtered_trimmed_sorted_interleaved_postmask_chrUn_removed_inexactSplitsRemoved_maf-convert.sam

# Feb 3, 2023
maf-convert -j1e6 -d sam transcript-to-genome.maf > transcript-to-genome.sam

# June 14, 2023
# lanc_oik_alignment.sh
# lastdb
lastdb -P8 -uMAM8 $dbName ~/big_oiks/lancelets/genome_assemblies_branchiostoma_floridae/ncbi-genomes-2023-06-13/GCF_000003815.2_Bfl_VNyyK_genomic.fna 
# last-train
last-train -P8 --revsym -E0.05 $dbName/$dbName ~/big_oiks/last/OKI2018_I69_1.0.removed_chrUn.fa > $trainFile
# alignment 1
lastal -E0.05 --split-f=MAF+ -p $trainFile $dbName/$dbName ~/big_oiks/last/OKI2018_I69_1.0.removed_chrUn.fa > $maf1
# alignment 2
last-split -r -m1e-5 $maf1 | last-postmask > $maf2
# maf-convert
maf-convert -j1e5 -d sam $maf2 > $sam2
# last-dotplot
last-dotplot $maf2 $pngFile


# June 15, 2023
#
#last-train B.floridae transcriptome 
# -P8: "makes it faster by using 8 parallel threads: adjust as suitable for your computer.
#         this has no effect on the result"
# -X1: "tells it to treat Ns in the reference sequences as unknown bases" -m100: Maximum multiplicity for initial matches.  Each initial match is
#        lengthened until it occurs at most this many times in the reference. "makes it more slow-and-sensitive than the default"
last-train -P8 --revsym -X1 -m100 F-Lanceletdb/F-Lanceletdb ../lancelets/transcriptome/GETA01.1.fsa_nt > b_floridae_transcript.train

# lastal --split OKI2018_I69.transcriptonme.fa 
# -D10: Report alignments that are expected by chance at most once per LENGTH query letters.
# CAVEAT: unknown intron length distribution 
lastal -P8 -D10 --split-d 2 -p b_floridae_transcript.train F-Lanceletdb/F-Lanceletdb ../lancelets/transcriptome/GETA01.1.fsa_nt | last-postmask > b_floridae_transcript_to_genome.maf

# maf-convert
maf-convert -j1e6 -d sam b_floridae_transcript_to_genome.maf > b_floridae_transcript_to_genome.sam 

# last-dotplot
#################
# DIDN'T WORK :(
#################
last-dotplot -1 NC_049979.1 ~/big_oiks/lanc_oik_last/FLancOik2_20230614.maf ~/big_oiks/lanc_oik_last/FLancOik2_20230614_NC_049979.1.png

# July 6, 2023
DATE=$1
dbName="F-Lanceletdb"
trainFile="Oik2Lanc.train"
maf="eachOikPart_OnePartInLanc_alignment_$DATE.maf"
sam="eachOikPart_OnePartInLanc_alignment_$DATE.sam"
pngFile="eachOikPart_OnePartInLanc_alignment_$DATE.png"

cd ~/oikdata/lanc_oik_last

# lastdb
echo "---lastdb"
if [ ! -d /home/mrk/oikdata/lanc_oik_last/$dbName ]; then
        echo "making lastdb"
        mkdir $dbName
        cd $dbName
        lastdb -P8 -uMAM8 $dbName ~/oikdata/lancelets/genome_assemblies_branchiostoma_floridae/ncbi-genomes-2023-06-13/GCF_000003815.2_Bfl_VNyyK_genomic.fna 
        cd ..
else
        echo "$dbName already exists"
fi

# last-train
echo "--last-train"
if [ ! -e $trainFile ]; then
        echo "doing last-train"
        last-train -P8 --revsym -E0.05 $dbName/$dbName ~/oikdata/last/OKI2018_I69_1.0.removed_chrUn.fa > $trainFile
else
        echo "$trainFile already exists"
fi

# lastal 
echo "---lastal"
if [ ! -e $maf ]; then 
        echo "doing lastal phase 1"
        lastal -E0.05 --split-f=MAF+ -p $trainFile $dbName/$dbName ~/oikdata/last/OKI2018_I69_1.0.removed_chrUn.fa | last-postmask > $maf
else
        echo "$maf already exists"
fi

# maf-convert sam
if [ ! -e $sam ]; then
        echo "converting maf to sam"
        maf-convert -j1e5 -d sam $maf > $sam
else
        echo "$sam already exists"
fi

# last-dotplot
echo "---last-dotplot"
if [ ! -e $pngFile ]; then
        echo "making $pngFile"
        #last-dotplot -a ~/oikdata/lancelets/ncbi_dataset/data/GCF_000003815.2/genomic.gff $maf $pngFile
        last-dotplot $maf $pngFile
else
        echo "$pngFile already exists"
fi

# July 20, 2023
dbNAME="OKI2018_I69_1.0db"
train_emb="train_OKI2018_I69_1.0_ERR4570985.out"
train_imm="train_OKI2018_I69_1.0_ERR4570986.out"
train_mat="train_OKI2018_I69_1.0_ERR4570987.out"
al_emb1="lastsplitOKI2018_I69_1.0_ERR4570985_1_filtered_trimmed_sorted_numbered_postmask_$DATE.maf"
al_emb2="lastsplitOKI2018_I69_1.0_ERR4570985_2_filtered_trimmed_sorted_numbered_postmask_$DATE.maf"
al_emb_combined="lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted_numbered_postmask_combined_$DATE.maf"
al_imm1="lastsplitOKI2018_I69_1.0_ERR4570986_1_filtered_trimmed_sorted_numbered_postmask_$DATE.maf"
al_imm2="lastsplitOKI2018_I69_1.0_ERR4570986_2_filtered_trimmed_sorted_numbered_postmask_$DATE.maf"
al_imm_combined="lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted_numbered_postmask_combined_$DATE.maf"
al_mat1="lastsplitOKI2018_I69_1.0_ERR4570987_1_filtered_trimmed_sorted_numbered_postmask_$DATE.maf"
al_mat2="lastsplitOKI2018_I69_1.0_ERR4570987_2_filtered_trimmed_sorted_numbered_postmask_$DATE.maf"
al_mat_combined="lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted_numbered_postmask_combined_$DATE.maf"
sam_emb="${al_emb_combined:0:-4}.sam"
sam_imm="${al_imm_combined:0:-4}.sam"
sam_mat="${al_mat_combined:0:-4}.sam"
fai_FILE="~/oikopleura/last/OKI2018_I69_1.0.removed_chrUn.fa.fai"
SORT_BAM_emb="${sam_emb:0:-4}.sort.bam"
SORT_BAM_imm="${sam_imm:0:-4}.sort.bam"
SORT_BAM_mat="${sam_mat:0:-4}.sort.bam"

cd ~/oikopleura/last
echo "dbName: $dbNAME"

############################
# lastdb
############################
echo "---lastdb"
if [ ! -d $dbNAME ]; then
        echo "making lastdb"
        mkdir $dbNAME
        cd $dbNAME
        lastdb -P8 -uNEAR $dbNAME ../OKI2018_I69_1.0.fa
        cd ..
else
        echo "$dbNAME already exists"
fi

###########################
# last-train
###########################
echo "---last-train"
# embryos
if [ ! -e embryos/$train_emb ]; then
        echo "doing last-train on embryos"
        pwd
        last-train -P8 -Q1 $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_filtered_trimmed_sorted_interleaved.fastq > embryos/$train_emb
else
        echo "embryos/$train_emb already exists"
fi

# immature adults
if [ ! -e immatureAdults/$train_imm ]; then
        echo "doing last-train on immature adults"
        last-train -P8 -Q1 $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_filtered_trimmed_sorted_interleaved.fastq > immatureAdults/$train_imm
else
        echo "immatureAdults/$train_imm already exists"
fi

# matured adults
if [ ! -e maturedAdults/$train_mat ]; then
        echo "doing last-train on matured adults"
        last-train -P8 -Q1 $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_filtered_trimmed_sorted_interleaved.fastq > maturedAdults/$train_mat
else
        echo "maturedAdults/$train_mat already exists"
fi

##########################
# lastal
##########################
echo "---lastal"
# embryos
# - spliced alignment of Read1
if [ ! -e embryos/$al_emb1 ]; then
        echo "doing spliced-alignment on embryos (Read1)"
        lastal -i1 -P8 -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p embryos/$train_emb $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted_numbered.fastq | last-postmask > embryos/$al_emb1
else
        echo "embryos/$al_emb1 already exists"
fi
# - spliced alignment of Read2
if [ ! -e embryos/$al_emb2 ]; then
        echo "doing spliced-alignment on embryos (Read2)"
        lastal -i1 -P8 -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p embryos/$train_emb $dbNAME/$dbNAME ../rna-seq-data/embryos/ERR4570985_2_filtered_trimmed_sorted_numbered.fastq | last-postmask > embryos/$al_emb2
else
        echo "embryos/$al_emb2 already exists"
fi

# - combine al_emb1 and al_emb2
if [ ! -e embryos/$al_emb_combined ]; then
        echo "combining al_emb1 and al_emb2"
        cat embryos/$al_emb1 embryos/$al_emb2 > embryos/$al_emb_combined
else
        echo "embryos/$al_emb_combined already exists"
fi

# - maf-convert sam
if [ ! -e embryos/$sam_emb ]; then
        echo "converting maf to sam"
        # pwd
        maf-convert -j1e5 -d sam embryos/$al_emb_combined > embryos/$sam_emb 
else
        echo "embryos/$sam_emb already exists"
fi
# - convert SAM -> BAM, sort, index
if [ ! -e embryos/$SORT_BAM_emb ]; then
        echo "converting sam to bam and sort"
        pwd
        samtools view -bt $fai_FILE embryos/$sam_emb | samtools sort -o embryos/$SORT_BAM_emb  
        echo "index embryos/$SORT_BAM_emb"
        samtools index embryos/$SORT_BAM_emb
else
        echo "embryos/$SORT_BAM_emb already exists"
fi

# immature adults
# - spliced alignment of Read1
if [ ! -e immatureAdults/$al_imm1 ]; then
        echo "doing spliced-alignment on immature adults (Read1)"
        lastal -i1 -P8 -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p immatureAdults/$train_imm $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_1_filtered_trimmed_sorted_numbered.fastq | last-postmask > immatureAdults/$al_imm1
else
        echo "immatureAdults/$al_imm1 already exists"
fi
# - spliced alignment of Read2
if [ ! -e immatureAdults/$al_imm2 ]; then
        echo "doing spliced-alignment on immature adults (Read2)"
        lastal -i1 -P8 -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p immatureAdults/$train_imm $dbNAME/$dbNAME ../rna-seq-data/immatureAdults/ERR4570986_2_filtered_trimmed_sorted_numbered.fastq | last-postmask > immatureAdults/$al_imm2
else
        echo "immatureAdults/$al_imm2 already exists"
fi

# - combine al_imm1 and al_imm2
if [ ! -e "immatureAdults/$al_imm_combined" ]; then
        echo "combining al_imm1 and imm2"
        cat immatureAdults/$al_imm1 immatureAdults/$al_imm2 > immatureAdults/$al_imm_combined
else
        echo "immatureAdults/$al_imm_combined already exists"

fi

# - maf-convert sam
if [ ! -e immatureAdults/$sam_imm ]; then
        echo "convert maf to sam"
        maf-convert -j1e5 -d sam immatureAdults/$al_imm_combined > immatureAdults/$sam_imm 
else
        echo "immatureAdults/$sam_imm already exists"
fi

# - convert SAM -> BAM, sort, index
if [ ! -e immatureAdults/$SORT_BAM_imm ]; then
        echo "converting sam to bam and sort"
        samtools view -bt $fai_FILE immatureAdults/$sam_imm | samtools sort -o immatureAdults/$SORT_BAM_imm  
        echo "index immatureAdults/$SORT_BAM_imm"
        samtools index immatureAdults/$SORT_BAM_imm
else
        echo "immatureAdults/$SORT_BAM_imm already exists"
fi

# mature adults
# - spliced alignment of Read1
if [ ! -e maturedAdults/$al_mat1 ]; then
        echo "doing spliced-alignment on matured adults (Read1)"
        lastal -i1 -P8 -D10 --split-d 0 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p maturedAdults/$train_mat $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_1_filtered_trimmed_sorted_numbered.fastq | last-postmask > maturedAdults/$al_mat1
else
        echo "maturedAdults/$al_mat1 already exists"
fi
# - spliced alignment of Read2
if [ ! -e maturedAdults/$al_mat2 ]; then
        echo "doing spliced-alignment on matured adults (Read2)"
        lastal -i1 -P8 -D10 --split-d 1 --split-M 3.78 --split-S 0.065 --split-m 0.5 -p maturedAdults/$train_mat $dbNAME/$dbNAME ../rna-seq-data/maturedAdults/ERR4570987_2_filtered_trimmed_sorted_numbered.fastq | last-postmask > maturedAdults/$al_mat2
else
        echo "maturedAdults/$al_mat2 already exists"
fi

# - combine al_mat1 and al_mat2
if [ ! -e "maturedAdults/$al_mat_combined" ];then
        echo "combining al_mat1 and al_mat2"
        cat maturedAdults/$al_mat1 maturedAdults/$al_mat2 > maturedAdults/$al_mat_combined
else
        echo "maturedAdults/$al_mat_combined already exists"
fi

# - maf-convert sam
if [ ! -e maturedAdults/$sam_mat ]; then
        echo "converting maf to sam"
        maf-convert -j1e5 -d sam maturedAdults/$al_mat_combined > maturedAdults/$sam_mat 
else
        echo "maturedAdults/$sam_mat already exists"
fi
# - convert SAM -> BAM, sort, index
if [ ! -e maturedAdults/$SORT_BAM_mat ]; then
        echo "converting sam to bam and sort"
        samtools view -bt $fai_FILE maturedAdults/$sam_mat| samtools sort -o maturedAdults/$SORT_BAM_mat  
        echo "index maturedAdults/$SORT_BAM_mat"
        samtools index maturedAdults/$SORT_BAM_mat
else
        echo "maturedAdults/$SORT_BAM_mat already exists"
fi

# Aug 21, 2023
# last-dotplot with options
python ~/biohazard/oikopleura/last/last-dotplot_mariko.py --sort1=3 --strands1=1 --border-color=silver --border-pixels=5 --rot1=v --labels1=3 --labels2=3 -a ~/biohazard/data/lancelets/ncbi_dataset/data/GCF_000003815.2/genomic.gff -b ~/biohazard/data/oikopleura/OKI2018_I69_1.0.gm.gff \*chr1_2188123-2188595.maf ~/Desktop/test_\*chr1_2188123-2188595.png

# Sep 11, 2023
# eachESharkPart_OnePartInLanc.sh
#!/bin/bash    

if [ $# -ne 1 ]; then
        echo "You need 1 argument" 1>&2
        echo "- today's date" 1>&2
        exit 1
fi

DATE=$1
dbName="F-Lanceletdb"
trainFile="EShark2Lanc.train"
maf="eachESharkPart_OnePartInLanc_alignment_$DATE.maf"
sam="eachESharkPart_OnePartInLanc_alignment_$DATE.sam"
pngFile="eachESharkPart_OnePartInLanc_alignment_$DATE.png"

cd ~/oikopleura/lanc_eshark_last

# lastdb
echo "---lastdb"
if [ ! -d /home/mrk/oikopleura/lanc_eshark_last/$dbName ]; then
        echo "making lastdb"
        mkdir $dbName
        cd $dbName
        lastdb -P8 -uMAM8 $dbName ~/oikopleura/lancelets/genome_assemblies_branchiostoma_floridae/ncbi-genomes-2023-06-13/GCF_000003815.2_Bfl_VNyyK_genomic.fna
        cd ..
else
        echo "$dbName already exists"
fi

# last-train
echo "--last-train"
if [ ! -e $trainFile ]; then
        echo "doing last-train"
        last-train -P8 --revsym -E0.05 $dbName/$dbName ~/oikopleura/elephantShark/ncbi_dataset/data/GCF_018977255.1/GCF_018977255.1_IMCB_Cmil_1.0_genomic.fna > $trainFile
else
        echo "$trainFile already exists"
fi

# lastal 
echo "---lastal"
if [ ! -e $maf ]; then 
        echo "doing lastal"
        lastal -E0.05 --split-f=MAF+ -p $trainFile $dbName/$dbName ~/oikopleura/elephantShark/ncbi_dataset/data/GCF_018977255.1/cds_from_genomic.fna | last-postmask > $maf
else
        echo "$maf already exists"
fi

# maf-convert sam
if [ ! -e $sam ]; then
        echo "converting maf to sam"
        maf-convert -j1e5 -d sam $maf > $sam
else
        echo "$sam already exists"
fi

# last-dotplot
echo "---last-dotplot"
if [ ! -e $pngFile ]; then
        echo "making $pngFile"
        last-dotplot $maf $pngFile
else
        echo "$pngFile already exists"
fi

# Sep 19, 2023
# eachESharkPart_OnePartInLanc_alignment.sh
#!/bin/bash

if [ $# -ne 1 ]; then
        echo "You need 1 argument" 1>&2
        echo "- today's date" 1>&2
        exit 1
fi

DATE=$1
dbName="F-Lanceletdb"
trainFile="EShark2Lanc.train"
maf="eachESharkPart_OnePartInLanc_alignment_$DATE.maf"
sam="eachESharkPart_OnePartInLanc_alignment_$DATE.sam"
pngFile="eachESharkPart_OnePartInLanc_alignment_$DATE.png"

cd ~/oikopleura/lanc_eshark_last

# lastdb
echo "---lastdb"
if [ ! -d /home/mrk/oikopleura/lanc_eshark_last/$dbName ]; then
        echo "making lastdb"
        mkdir $dbName
        cd $dbName
        lastdb -P8 -uMAM8 $dbName ~/oikopleura/lancelets/genome_assemblies_branchiostoma_floridae/ncbi-genomes-2023-06-13/GCF_000003815.2_Bfl_VNyyK_genomic.fna
        cd ..
else
        echo "$dbName already exists"
fi

# last-train
echo "--last-train"
if [ ! -e $trainFile ]; then
        echo "doing last-train"
        last-train -P8 --revsym -E0.05 $dbName/$dbName ~/oikopleura/elephantShark/ncbi_dataset/data/GCF_018977255.1/GCF_018977255.1_IMCB_Cmil_1.0_genomic.fna > $trainFile
else
        echo "$trainFile already exists"
fi

# lastal 
echo "---lastal"
if [ ! -e $maf ]; then 
        echo "doing lastal"
        lastal -E0.05 --split-f=MAF+ -p $trainFile $dbName/$dbName ~/oikopleura/elephantShark/ncbi_dataset/data/GCF_018977255.1/GCF_018977255.1_IMCB_Cmil_1.0_genomic.fna | last-postmask > $maf
else
        echo "$maf already exists"
fi

# maf-convert sam
if [ ! -e $sam ]; then
        echo "converting maf to sam"
        maf-convert -j1e5 -d sam $maf > $sam
else
        echo "$sam already exists"
fi

# last-dotplot
echo "---last-dotplot"
if [ ! -e $pngFile ]; then
        echo "making $pngFile"
        last-dotplot $maf $pngFile
else
        echo "$pngFile already exists"
fi

# February 21, 2024
./one2one.sh 20240221 ~/data/oikAlb_oikDio/ ~/genomes/oikAlb/GCA_004367875.1_ASM436787v1_genomic.fna ~/genomes/oikDio/OKI2018_I69_1.0.removed_chrUn.fa oikAlb oikDio 1e7
./one2one.sh 20240221 ~/data/phyBuc_pomCan/ ~/genomes/phymorhynchusBuccinoides/GCA_017654935.2_ASM1765493v2_genomic.fna ~/genomes/pomaceaCanaliculata/GCA_036321745.1_ASM3632174v1_genomic.fna phyBuc pomCan 1e8

# March 10, 2024
./one2one.sh 20240310 ~/data/oikDio_oikAlb/ ~/genomes/oikDio/OKI2018_I69_1.0.removed_chrUn.fa ~/genomes/oikAlb/GCA_004367875.1_ASM436787v1_genomic.fna oikDio oikAlb 1e8

# March 11, 2024
./one2one.sh 20240311 ~/data/bathBro_bathSep/ ~/genomes/bathymodiolusBrooksi/GCA_963680875.1_xbBatBroo1.1_genomic.fna ~/genomes/bathymodiolusSeptemdierum/GCA_963383655.1_xbBatSept2.1_genomic.fna bathBro bathSep 1e9

# March 27, 2024
./uvmut_3spc.sh 20240327 ~/genomes/gigantidasPlatifrons/GCA_002080005.1_Bpl_v1.0_genomic.fna ~/genomes/bathymodiolusSeptemdierum/GCA_963383655.1_xbBatSept2.1_genomic.fna ~/genomes/bathymodiolusBrooksi/GCA_963680875.1_xbBatBroo1.1_genomic.fna gPla bSep bBro ~/data

# April 15, 2024
./uvmut_3spc.sh 20240415 ~/data/genomes/oikDio/OKI2018_I69_1.0.removed_chrUn.fa ~/data/genomes/oikAlb/GCA_004367875.1_ASM436787v1_genomic.fna ~/data/genomes/oikVan/GCA_004367855.1_ASM436785v1_genomic.fna oikDio oikAlb oikVan ~/data

# April 22, 2024
./uvmut_3spc.sh 20240422 ~/genomes/ulvaProlifera/GCA_023078555.1_ASM2307855v1_genomic.fna ~/genomes/ulvaMutabilis/GCA_900538255.1_Ulvmu_WT_fa_genomic.fna ~/genomes/ulvaCompressa/GCA_024500015.1_ASM2450001v1_genomic.fna uPro uMut uCom ~/data

# April 23, 2024
./uvmut_3spc.sh 20240423 ~/genomes/ostreococcusMediterraneus/GCA_012295225.1_ASM1229522v1_genomic.fna ~/genomes/ostreococcusTauri/GCF_000214015.3_version_140606_genomic.fna ~/genomes/ostreococcusLucimarinus/GCF_000092065.1_ASM9206v1_genomic.fna ostMed ostTau ostLuc ~/data

./uvmut_3spc.sh 20240423 ~/genomes/protothecaCutis/GCA_002897115.2_JCM_15793_assembly_v001_genomic.fna ~/genomes/protothecaCiferrii/GCA_003613005.1_ASM361300v1_genomic.fna ~/genomes/protothecaBovis/GCA_003612995.1_ASM361299v1_genomic.fna proCut proCif proBov ~/data

# April 28, 2024
./uvmut_3spc.sh 20240428 ~/genomes/mytilusTrossulus/GCF_036588685.1_PNRI_Mtr1.1.1.hap1_genomic.fna ~/genomes/mytilusEdulis/GCA_019925275.1_PEIMed_genomic.fna ~/genomes/mytilusGalloprovincialis/GCA_037788925.1_MytGallo_primary_0.1_genomic.fna mytTro mytEdu mytGal ~/data

# June 10, 2024
./uvmut_3spc.sh 20240415 ~/genomes/oikDio/OKI2018_I69_1.0.removed_chrUn.fa ~/genomes/oikAlb/GCA_004367875.1_ASM436787v1_genomic.fna ~/genomes/oikVan/GCA_004367855.1_ASM436785v1_genomic.fna oikDio oikAlb oikVan ~/data

./uvmut_3spc.sh 20240610 ~/genomes/gigantidasPlatifrons/GCA_002080005.1_Bpl_v1.0_genomic.fna ~/genomes/bathymodiolusSeptemdierum/GCA_963383655.1_xbBatSept2.1_genomic.fna ~/genomes/bathymodiolusBrooksi/GCA_963680875.1_xbBatBroo1.1_genomic.fna gigPla batSep batBro ~/data

./uvmut_3spc.sh 20240428 ~/genomes/mytilusTrossulus/GCF_036588685.1_PNRI_Mtr1.1.1.hap1_genomic.fna ~/genomes/mytilusEdulis/GCA_019925275.1_PEIMed_genomic.fna ~/genomes/mytilusGalloprovincialis/GCA_037788925.1_MytGallo_primary_0.1_genomic.fna mytTro mytEdu mytGal ~/data

./uvmut_3spc.sh 20240423 ~/genomes/ostreococcusMediterraneus/GCA_012295225.1_ASM1229522v1_genomic.fna ~/genomes/ostreococcusTauri/GCF_000214015.3_version_140606_genomic.fna ~/genomes/ostreococcusLucimarinus/GCF_000092065.1_ASM9206v1_genomic.fna ostMed ostTau ostLuc ~/data

./uvmut_3spc.sh 20240423 ~/genomes/protothecaCutis/GCA_002897115.2_JCM_15793_assembly_v001_genomic.fna ~/genomes/protothecaCiferrii/GCA_003613005.1_ASM361300v1_genomic.fna ~/genomes/protothecaBovis/GCA_003612995.1_ASM361299v1_genomic.fna proCut proCif proBov ~/data

$ ./uvmut_3spc.sh 20240610 ~/genomes/ulvaProlifera/GCA_023078555.1_ASM2307855v1_genomic.fna ~/genomes/ulvaMutabilis/GCA_900538255.1_Ulvmu_WT_fa_genomic.fna ~/genomes/ulvaCompressa/GCA_024500015.1_ASM2450001v1_genomic.fna ulvPro ulvMut ulvCom ~/data

# June 11, 2024
./uvmut_3spc_fromDwl.sh 20240611 GCF_000263375.1 GCF_000400465.1 GCA_004918325.1 wallemiaMellicola wallemiaIchthyophaga wallemiaHederae

# June 17, 2024
./uvmut_3spc_fromDwl.sh 20240617 GCA_037044115.1 GCF_016861735.1 GCA_034509305.1 aspergillusCostiformis aspergillusChevalieri aspergillusCristatus > output.log 2> error.log

# August 2, 2024
./uvmut_3spc.sh 20240802 ~/genomes/chloroplast/Oenothera_argillicola_chloroplast.fasta ~/genomes/chloroplast/Oenothera_oakesiana_chloroplast.fasta ~/genomes/chloroplast/Oenothera_parviflora_chloroplast.fasta oenArg oenOak oenPar ~/data/

./uvmut_3spc.sh 20240802 ~/genomes/chloroplast/Oenothera_argillicola_chloroplast.fasta ~/genomes/chloroplast/Oenothera_glazioviana_chloroplast.fasta ~/genomes/chloroplast/Oenothera_elata_subsp_hookeri_chloroplast.fasta oenArg oenGla oenEla ~/data

# August 26, 2024
./uvmut_3spc.sh 20240826 ~/genomes/chloroplast/Ulva_prolifera_chloroplast.fasta ~/genomes/chloroplast/Ulva_mutabilis_chloroplast.fasta ~/genomes/chloroplast/Ulva_compressa_chloroplast.fasta ulvProCh ulvMutCh ulvComCh ~/data

# September 3, 2024
./uvmut_3spc.sh 20240903 ~/genomes/chloroplast/Prototheca_cutis_chloroplast.fasta ~/genomes/chloroplast/Prototheca_ciferrii_chloroplast.fasta ~/genomes/chloroplast/Prototheca_bovis_chloroplast.fasta proCutCh proCifCh proBovCh ~/data

# September 10, 2024
./uvmut_3spc_fromDwl.sh 20240910 GCF_031729055.1 GCF_000011345.1 GCF_003555505.1 pseudocalidococcusAzoricus thermosynechococcusVestitus thermosynechococcusSichuanensis

# October 4, 2024
./uvmut_3spc.sh 20241004 /home/mrk/genomes/protothecaWickerhamii/GCA_031763795.1_ASM3176379v1_genomic.fna /home/mrk/genomes/protothecaBovis/GCA_003612995.1_ASM361299v1_genomic.fna /home/mrk/genomes/protothecaCiferrii/GCA_003613005.1_ASM361300v1_genomic.fna proWic proBov proCif /home/mrk/data/

./uvmut_3spc.sh 20241004 /home/mrk/genomes/mitochondria/Prototheca_wickerhamii_mitochondrion.fasta /home/mrk/genomes/mitochondria/Prototheca_bovis_mitochondrion.fasta /home/mrk/genomes/mitochondria/Prototheca_ciferrii_mitochondrion.fasta proWicMt proBovMt proCifMt /home/mrk/data

./uvmut_3spc.sh 20241004 /home/mrk/genomes/plastids/Prototheca_wickerhamii_plastid.fasta /home/mrk/genomes/plastids/Prototheca_bovis_plastid.fasta /home/mrk/genomes/plastids/Prototheca_ciferrii_plastid.fasta proWicPl proBovPl proCifPl /home/mrk/data/

./uvmut_3spc.sh 20241004 /home/mrk/genomes/plastids/Prototheca_bovis_plastid.fasta /home/mrk/genomes/plastids/Prototheca_ciferrii_plastid.fasta /home/mrk/genomes/plastids/Prototheca_zopfii_ATTCC16533_plastid.fasta proBovPl proCifPl proZofPl /home/mrk/data/

./uvmut_3spc.sh 20241004 /home/mrk/genomes/plastids/Prototheca_cerasi_JCM9400_plastid.fasta /home/mrk/genomes/plastids/Prototheca_bovis_plastid.fasta /home/mrk/genomes/plastids/Prototheca_vistulensis_W3_plastid.fasta proCerPl proBovPl proVisPl /home/mrk/data/

# July 24, 2025
./last_train.sh 20250724 ~/data/cyaGra_parMar_proMar/ ~/genomes/parasynechococcusMarenigrum/GCF_000195975.1_ASM19597v1_genomic.fna ~/genomes/prochlorococcusMarinus/GCF_000015665.1_ASM1566v1_genomic.fna parMar proMar &> ~/log/20250724_lt_parMar_proMar.log &

# July 30, 2025
./last_train.sh 20250730 ~/data/oikDio_oikAlb_oikVan/ ~/genomes/oikopleuraAlbicans/GCA_004367875.1_ASM436787v1_genomic.fna ~/genomes/oikopleuraVanhoeffeni/GCA_004367855.1_ASM436785v1_genomic.fna oikAlb oikVan &> ~/log/20250730_lt_oikAlb_oikVan.log &

./last_train.sh 20250730 ~/data/proWic_proBov_proCif/ ~/genomes/protothecaBovis/GCA_003612995.1_ASM361299v1_genomic.fna ~/genomes/protothecaCiferrii/GCA_003613005.1_ASM361300v1_genomic.fna proBov proCif &> ~/log/20250730_lt_proBov_proCif.log

./last_train.sh 20250730 ~/data/pseAzo_theVes_theSic/ ~/genomes/thermosynechococcusVestitus/GCF_000011345.1_ASM1134v1_genomic.fna ~/genomes/thermosynechococcusSichuanensis/GCF_003555505.1_ASM355550v2_genomic.fna theVes theSic &> ~/log/20250730_lt_theVes_theSic.log &

./last_train.sh 20250730 ~/data/arcCen_ampZal_ampCit/ ~/genomes/amphilophusZaliosus/GCA_015108585.1_JWE1.scf_genomic.fna ~/genomes/amphilophusCitrinellus/GCA_013435755.1_ASM1343575v1_genomic.fna ampZal ampCit &> ~/log/20250730_lt_ampZal_ampCit.log &

./last_train.sh 20250730 ~/data/mytTro_mytEdu_mytGal/ ~/genomes/mytilusEdulis/GCA_019925275.1_PEIMed_genomic.fna ~/genomes/mytilusGalloprovincialis/GCA_037788925.1_MytGallo_primary_0.1_genomic.fna mytTro mytGal &> ~/log/20250730_lt_mytEdu_mytGal.log &

