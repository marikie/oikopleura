# May 30, 2022
# STAR: genome indexing
STAR --runThreadN 3 --runMode genomeGenerate --genomeDir genome_index_STAR --genomeFastaFiles ~/data/oikopleura/OKI2018_I69_1.0_alignments_with_different_parameters/copy_of_the_genomes/OKI2018_I69_1.0.removed_chrUn.fa --genomeSAindexNbases 11
# STAR: 1st pass mapping
STAR --runThreadN 3 --genomeDir genome_index_STAR --outFileNamePrefix embryos --readFilesIn ~/data/oikopleura/rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted.fastq ~/data/oikopleura/rna-seq-data/embryos/ERR4570985_2_filtered_trimmed_sorted.fastq --outSJfilterReads Unique
STAR --runThreadN 3 --genomeDir genome_index_STAR --outFileNamePrefix immaureAdults --readFilesIn ~/data/oikopleura/rna-seq-data/immatureAdults/ERR4570986_1_filtered_trimmed_sorted.fastq ~/data/oikopleura/rna-seq-data/immatureAdults/ERR4570986_2_filtered_trimmed_sorted.fastq --outSJfilterReads Unique
STAR --runThreadN 3 --genomeDir genome_index_STAR --outFileNamePrefix maturedAdults --readFilesIn ~/data/oikopleura/rna-seq-data/maturedAdults/ERR4570987_1_filtered_trimmed_sorted.fastq ~/data/oikopleura/rna-seq-data/maturedAdults/ERR4570987_2_filtered_trimmed_sorted.fastq --outSJfilterReads Unique

# ---- embryos vs matured ---
# STAR: 2nd pass mapping
STAR --runThreadN 3 --genomeDir genome_index_STAR --outFileNamePrefix embryos --readFilesIn ~/data/oikopleura/rna-seq-data/embryos/ERR4570985_1_filtered_trimmed_sorted.fastq ~/data/oikopleura/rna-seq-data/embryos/ERR4570985_2_filtered_trimmed_sorted.fastq --outSJfilterReads Unique --outSAMstrandField intronMotif --outFilterMultimapNmax 1 -sjdbFileChrStartEnd 1st_SJ/embryosSJ.out.tab 1st_SJ/maturedAdultsSJ.out.tab
STAR --runThreadN 3 --genomeDir genome_index_STAR --outFileNamePrefix matured --readFilesIn ~/data/oikopleura/rna-seq-data/maturedAdults/ERR4570987_1_filtered_trimmed_sorted.fastq ~/data/oikopleura/rna-seq-data/maturedAdults/ERR4570987_2_filtered_trimmed_sorted.fastq --outSJfilterReads Unique --outSAMstrandField intronMotif --outFilterMultimapNmax 1 -sjdbFileChrStartEnd 1st_SJ/embryosSJ.out.tab 1st_SJ/maturedAdultsSJ.out.tab
