# --- May 24, 2022 ---
# embryos
cd ~/data/oikopleura/last/embryos

maf-convert sam lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.maf > lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.sam
# immatureAdults
cd ~/data/oikopleura/last/immatureAdults

maf-convert sam lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.maf > lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.sam
# maturedAdults
cd ~/data/oikopleura/last/maturedAdults

maf-convert sam lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.maf > lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.sam

# --- May 25, 2022 ---
cd ~/data/oikopleura/last
samtools faidx OKI2018_I69_1.0.removed_chrUn.fa
# embryos
cd ~/data/oikopleura/last/embryos
samtools view -bt ../OKI2018_I69_1.0.removed_chrUn.fa.fai lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.sam > lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.bam
# immatureAdults
cd ~/data/oikopleura/last/immatureAdults
samtools view -bt ../OKI2018_I69_1.0.removed_chrUn.fa.fai lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.sam > lastsplitOKI2018_I69_1.0_ERR4570986_sorted.bam
# maturedAdults
cd ~/data/oikopleura/last/maturedAdults
samtools view -bt ../OKI2018_I69_1.0.removed_chrUn.fa.fai lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.sam > lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.bam

# --- May 26, 2022 ---
# embryos
cd ~/data/oikopleura/leafcutter/embryos
samtools sort ../../last/embryos/lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.bam -o lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.sort.bam
regtools junctions extract -s 0 -a 8 -m 30 -M 1000 lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.sort.bam -o lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.sort.junc
# immatureAdults
cd ~/data/oikopleura/leafcutter/immatureAdults
samtools sort ../../last/immatureAdults/lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.bam -o lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.sort.bam
regtools junctions extract -s 0 -a 8 -m 30 -M 1000 lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.sort.bam -o lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.sort.junc
# maturedAdults
cd ~/data/oikopleura/leafcutter/matureAdults
samtools sort ../../last/maturedAdults/lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.bam -o lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.sort.bam
regtools junctions extract -s 0 -a 8 -m 30 -M 1000 lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.sort.bam -o lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.sort.junc

echo lastsplitOKI2018_I69_1.0_ERR4570985_filtered_trimmed_sorted.sort.junc >> juncfiles.txt
echo lastsplitOKI2018_I69_1.0_ERR4570986_filtered_trimmed_sorted.sort.junc >> juncfiles.txt
echo lastsplitOKI2018_I69_1.0_ERR4570987_filtered_trimmed_sorted.sort.junc >> juncfiles.txt

python ~/.local/src/leafcutter/clustering/leafcutter_cluster_regtools.py -j juncfiles.txt -m 50 -o embryos_immature_matured -l 1000
